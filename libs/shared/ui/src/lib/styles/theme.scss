@use '@angular/material' as mat;
@use 'sass:map';
@use 'sass:color';
@use './tokens/tokens' as tokens;
@use './_light-theme.scss' as light;
@use './_dark-theme.scss' as dark;
@use './components';
@use './material-overrides';
// Core Material
@include mat.core();

// Base tokens (CSS variables shared by both themes)
:root {
  // Apply all design tokens from token registry
  @include tokens.all-css-vars();

  // Additional alpha variants for semantic colors
  --color-secondary-alpha-5: rgba(236, 72, 153, 0.05);
  --color-secondary-alpha-10: rgba(236, 72, 153, 0.1);
  --color-secondary-alpha-20: rgba(236, 72, 153, 0.2);
  --color-secondary-alpha-30: rgba(236, 72, 153, 0.3);
  --color-secondary-alpha-40: rgba(236, 72, 153, 0.4);
  --color-secondary-alpha-50: rgba(236, 72, 153, 0.5);
  --color-secondary-alpha-60: rgba(236, 72, 153, 0.6);
  --color-secondary-alpha-70: rgba(236, 72, 153, 0.7);
  --color-secondary-alpha-80: rgba(236, 72, 153, 0.8);
  --color-secondary-alpha-90: rgba(236, 72, 153, 0.9);

  --color-gray-alpha-5: rgba(148, 163, 184, 0.05);
  --color-gray-alpha-10: rgba(148, 163, 184, 0.1);
  --color-gray-alpha-20: rgba(148, 163, 184, 0.2);
  --color-gray-alpha-30: rgba(148, 163, 184, 0.3);
  --color-gray-alpha-40: rgba(148, 163, 184, 0.4);
  --color-gray-alpha-50: rgba(148, 163, 184, 0.5);
  --color-gray-alpha-60: rgba(148, 163, 184, 0.6);
  --color-gray-alpha-70: rgba(148, 163, 184, 0.7);
  --color-gray-alpha-80: rgba(148, 163, 184, 0.8);
  --color-gray-alpha-90: rgba(148, 163, 184, 0.9);

  // Glass surface effects - Modern and subtle
  --glass-surface: linear-gradient(135deg,
      rgba(255, 255, 255, 0.7),
      rgba(255, 255, 255, 0.4));
  --glass-border: rgba(255, 255, 255, 0.5);
  --glass-backdrop-blur: blur(12px);
  --glass-backdrop-saturate: saturate(180%);

  // Gradient definitions
  --gradient-hero-radial: radial-gradient(circle at top center,
      var(--interactive-primary-hover),
      transparent 70%);

  --gradient-hero-radial-light: radial-gradient(circle at top center,
      var(--interactive-primary),
      transparent 70%);

  // Subtle card gradients
  --gradient-card-hover: linear-gradient(135deg,
      var(--color-secondary-alpha-5),
      var(--color-primary-alpha-5));

  // Button gradient overlays
  --gradient-button-overlay: linear-gradient(to bottom,
      rgba(255, 255, 255, 0.15),
      rgba(255, 255, 255, 0));

  // Layout system
  --header-height: 64px;
  --header-height-mobile: 56px;

  // ============================================================================
  // CONTENT MAX-WIDTHS (Container Standards)
  // ============================================================================

  // Pixel-based max-widths
  --max-width-reading: 800px; // Text-heavy pages (optimal reading, 60-75 chars)
  --max-width-content: 1200px; // Standard app content (forms, mixed content)
  --max-width-wide: 1440px; // Wide layouts (grids, dashboards, browser)
  --max-width-section: 1280px; // Landing page sections (Material Design standard)

  // Character-based constraints (for optimal reading)
  --max-width-text-narrow: 65ch; // ~60-70 characters per line
  --max-width-text-normal: 75ch; // ~70-80 characters per line
  --max-width-text-wide: 85ch; // ~80-90 characters per line

  // ============================================================================
  // STATUS & SEMANTIC COLORS
  // ============================================================================

  // Success (Green)
  --status-success: #22c55e;
  --status-success-light: #86efac;
  --status-success-dark: #16a34a;
  --status-success-alpha-10: rgba(34, 197, 94, 0.1);
  --status-success-alpha-20: rgba(34, 197, 94, 0.2);

  // Warning (Yellow/Amber)
  --status-warning: #eab308;
  --status-warning-light: #fde047;
  --status-warning-dark: #ca8a04;
  --status-warning-alpha-10: rgba(234, 179, 8, 0.1);
  --status-warning-alpha-20: rgba(234, 179, 8, 0.2);

  // Error (Red)
  --status-error: #ef4444;
  --status-error-light: #fca5a5;
  --status-error-dark: #dc2626;
  --status-error-alpha-10: rgba(239, 68, 68, 0.1);
  --status-error-alpha-20: rgba(239, 68, 68, 0.2);

  // Info (Blue)
  --status-info: #3b82f6;
  --status-info-light: #93c5fd;
  --status-info-dark: #2563eb;
  --status-info-alpha-10: rgba(59, 130, 246, 0.1);
  --status-info-alpha-20: rgba(59, 130, 246, 0.2);

  // Disabled state
  --state-disabled-bg: var(--gray-100);
  --state-disabled-text: var(--gray-400);
  --state-disabled-border: var(--gray-200);
  --state-disabled-alpha: rgba(148, 163, 184, 0.4);

  // Selected/Active state
  --state-selected-bg: var(--color-primary-alpha-10);
  --state-selected-border: var(--electric-violet);
  --state-selected-text: var(--electric-violet);

  // Hover state
  --state-hover-bg: var(--color-gray-alpha-5);
  --state-hover-border: var(--gray-300);

  // Focus state
  --state-focus-ring: var(--electric-violet);
  --state-focus-ring-alpha: var(--color-primary-alpha-30);
}

// Apply light theme tokens and Material styles under :root
:root {
  @include light.light-theme-vars();
  @include light.light-material-theme();
}

// Dark mode: only colors get overridden under body class
body.dark-mode {
  @include dark.dark-theme-vars();
  @include dark.dark-material-theme();
}

// Fallback to system preference for first paint if no class
@media (prefers-color-scheme: dark) {
  body:not(.dark-mode) {
    @include dark.dark-theme-vars();
  }
}

@media (prefers-color-scheme: light) {
  body:not(.dark-mode) {
    @include light.light-theme-vars();
  }
}

// Apply global typography to body
body {
  @include tokens.apply-typography();
  // Sleek tight typography
  letter-spacing: -0.015em;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

// ============================================================================
// GLOBAL APP STYLES (Scrollbars, Selection, etc.)
// ============================================================================
@mixin apply-global-styles() {

  // Custom Sleek Scrollbar
  ::-webkit-scrollbar {
    width: 10px;
    height: 10px;
  }

  ::-webkit-scrollbar-track {
    background: transparent;
  }

  ::-webkit-scrollbar-thumb {
    background: var(--border-secondary);
    border-radius: 5px;
    border: 2px solid transparent;
    background-clip: content-box;

    &:hover {
      background-color: var(--text-tertiary);
    }
  }

  // Text Selection
  ::selection {
    background: var(--color-primary-alpha-20);
    color: var(--text-primary);
  }
}

// Apply global styles immediately
:root {
  @include apply-global-styles();
}


.text-primary {
  color: var(--text-primary);
}

.text-secondary {
  color: var(--text-secondary);
}

.text-tertiary {
  color: var(--text-tertiary);
}

.text-accent {
  color: var(--accent-color);
}

// Background utilities
.bg-primary {
  background: var(--background-primary);
}

.bg-secondary {
  background: var(--background-secondary);
}

.bg-surface {
  background: var(--surface-secondary);
}

// Border utilities
.border-primary {
  border-color: var(--border-primary);
}

.border-secondary {
  border-color: var(--border-secondary);
}

// Shadow utilities
.shadow-sm {
  box-shadow: var(--shadow-sm);
}

.shadow-md {
  box-shadow: var(--shadow-md);
}

.shadow-lg {
  box-shadow: var(--shadow-lg);
}

// Animation utilities
.transition-fast {
  transition-duration: var(--animation-duration-fast);
}

.transition-standard {
  transition-duration: var(--animation-duration-standard);
}

.transition-slow {
  transition-duration: var(--animation-duration-slow);
}

// ============================================================================
// RESPONSIVE BREAKPOINTS
// ============================================================================

$breakpoints: (
  xs: 0,
  sm: 576px,
  md: 768px,
  lg: 992px,
  xl: 1200px,
  xxl: 1400px
);

@mixin respond-to($breakpoint) {
  @media (min-width: map.get($breakpoints, $breakpoint)) {
    @content;
  }
}

// ============================================================================
// ANIMATIONS
// ============================================================================
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(16px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInUp {
  from {
    opacity: 0;
    transform: translateY(24px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes pulse {

  0%,
  100% {
    opacity: 1;
  }

  50% {
    opacity: 0.5;
  }
}

.fade-in {
  animation: fadeIn var(--animation-duration-standard) var(--animation-easing);
}

.slide-in-up {
  animation: slideInUp var(--animation-duration-slow) var(--animation-easing);
}

.pulse {
  animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
}

// Global Search Dialog Styles
.global-search-dialog {
  .mat-mdc-dialog-container {
    padding: 0;
    border-radius: var(--border-radius-lg);
    background: var(--surface-primary);
    box-shadow: var(--shadow-xl);

    .mat-mdc-dialog-surface {
      padding: 0;
      border-radius: var(--border-radius-lg);
      overflow: hidden;
    }
  }
}