<div class="challenge-container">

  <!-- User Todos Section -->
  <div class="user-todos-container">
    <!-- Filter Dropdown -->
    <div class="filter-container">
        <mat-form-field appearance="fill">
            <mat-label>Filter by Status</mat-label>
            <mat-select [value]="filterStatus()" (selectionChange)="onFilterChange($event.value)">
                <mat-option value="all">All</mat-option>
                <mat-option value="completed">Completed</mat-option>
                <mat-option value="pending">Pending</mat-option>
            </mat-select>
        </mat-form-field>
    </div>

    <!-- For UI Separation only - STARTS HERE -->
    <div class="view-mode">
        <span>View Mode:</span>
        <mat-radio-group [value]="viewMode()" (change)="onViewModeChange($event.value)">
            <mat-radio-button value="basic">Basic Filter</mat-radio-button>
            <mat-radio-button value="advanced">Advanced Filter</mat-radio-button>
        </mat-radio-group>
    </div>

    <!-- For UI Separation only - ENDS HERE -->

    <!-- ===== Basic Inline Filtering ===== -->
    @if(viewMode() === 'basic') {
    @let todos = todosWithUsers$ | async;
    <div class="basic-filtering">

        <h3>Basic Inline Filtering</h3>
        @if (todos?.length === 0) {
        <p>No data available</p>
        }
        @else {
        <table>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Task</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @for (todo of todos; track todo.id) {
                @if (
                filterStatus() === 'all' ||
                (filterStatus() === 'completed' && todo.completed) ||
                (filterStatus() === 'pending' && !todo.completed)
                ) {
                <tr>
                    <td>{{ todo.userName }}</td>
                    <td>{{ todo.title }}</td>
                    <td>
                        <mat-chip>
                            <span [ngClass]="todo.completed ? 'completed' : 'pending'"> {{ todo.completed ?
                                'Completed' : 'Pending' }} </span>
                        </mat-chip>
                    </td>
                </tr>
                }
                }
            </tbody>
        </table>
        }
    </div>
    }

    <!-- ===== Advanced Signal-Based Filtering ===== -->
    @if(viewMode() === 'advanced') {
    @let filtered = filteredTodos$() | async;
    <div class="advanced-filtering">

        <h3>Advanced Signal-Based Filtering</h3>
        @if (filtered?.length === 0) {
        <p>No data available</p>
        }

        @else {
        <table>
            <thead>
                <tr>
                    <th>User</th>
                    <th>Task</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                @for (todo of filtered; track todo.id) {
                <tr>
                    <td>{{ todo.userName }}</td>
                    <td>{{ todo.title }}</td>
                    <td>
                        <mat-chip>
                            <span [ngClass]="todo.completed ? 'completed' : 'pending'"> {{ todo.completed ?
                                'Completed' : 'Pending' }} </span>
                        </mat-chip>
                    </td>
                </tr>
                }
            </tbody>
        </table>
        }
    </div>
    }


</div>
</div>
