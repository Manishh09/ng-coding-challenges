<div class="user-form-container">
  <div class="form-header">
    <h1>User Profile Form</h1>
    <p class="subtitle">Try navigating away with unsaved changes to see the guard in action</p>
  </div>

  <!-- Status Messages -->
  <div class="status-messages">
    <div *ngIf="saved()" class="alert alert-success">
      âœ… Form saved successfully! Redirecting...
    </div>
    <div *ngIf="userForm.dirty && !saved()" class="alert alert-warning">
      âš ï¸ You have unsaved changes
    </div>
  </div>

  <!-- User Form -->
  <form [formGroup]="userForm" (ngSubmit)="onSubmit()" class="user-form">

    <!-- Name Row -->
    <div class="form-row">
      <div class="form-group">
        <label for="firstName">First Name *</label>
        <input
          type="text"
          id="firstName"
          formControlName="firstName"
          [class.error]="hasError('firstName')"
          placeholder="Enter first name"
        />
        <span *ngIf="hasError('firstName')" class="error-message">
          {{ getErrorMessage('firstName') }}
        </span>
      </div>

      <div class="form-group">
        <label for="lastName">Last Name *</label>
        <input
          type="text"
          id="lastName"
          formControlName="lastName"
          [class.error]="hasError('lastName')"
          placeholder="Enter last name"
        />
        <span *ngIf="hasError('lastName')" class="error-message">
          {{ getErrorMessage('lastName') }}
        </span>
      </div>
    </div>

    <!-- Contact Row -->
    <div class="form-row">
      <div class="form-group">
        <label for="email">Email *</label>
        <input
          type="email"
          id="email"
          formControlName="email"
          [class.error]="hasError('email')"
          placeholder="email@example.com"
        />
        <span *ngIf="hasError('email')" class="error-message">
          {{ getErrorMessage('email') }}
        </span>
      </div>

      <div class="form-group">
        <label for="phone">Phone *</label>
        <input
          type="tel"
          id="phone"
          formControlName="phone"
          [class.error]="hasError('phone')"
          placeholder="+1 (555) 123-4567"
        />
        <span *ngIf="hasError('phone')" class="error-message">
          {{ getErrorMessage('phone') }}
        </span>
      </div>
    </div>

    <!-- Address Fields -->
    <div class="form-group">
      <label for="address">Address *</label>
      <input
        type="text"
        id="address"
        formControlName="address"
        [class.error]="hasError('address')"
        placeholder="Street address"
      />
      <span *ngIf="hasError('address')" class="error-message">
        {{ getErrorMessage('address') }}
      </span>
    </div>

    <div class="form-row">
      <div class="form-group">
        <label for="city">City *</label>
        <input
          type="text"
          id="city"
          formControlName="city"
          [class.error]="hasError('city')"
          placeholder="City"
        />
        <span *ngIf="hasError('city')" class="error-message">
          {{ getErrorMessage('city') }}
        </span>
      </div>

      <div class="form-group">
        <label for="country">Country *</label>
        <input
          type="text"
          id="country"
          formControlName="country"
          [class.error]="hasError('country')"
          placeholder="Country"
        />
        <span *ngIf="hasError('country')" class="error-message">
          {{ getErrorMessage('country') }}
        </span>
      </div>
    </div>

    <!-- Form Actions -->
    <div class="form-actions">
      <button
        type="submit"
        class="btn btn-primary"
        [disabled]="saving()"
      >
        <span *ngIf="!saving()">ğŸ’¾ Save Profile</span>
        <span *ngIf="saving()">â³ Saving...</span>
      </button>

      <button
        type="button"
        class="btn btn-secondary"
        (click)="resetForm()"
        [disabled]="saving()"
      >
        ğŸ”„ Reset Form
      </button>

      <a
        routerLink="/challenges/angular-routing"
        class="btn btn-outline"
        [class.disabled]="saving()"
      >
        â† Back to Challenges
      </a>
    </div>
  </form>

  <!-- Test Navigation Links -->
  <div class="test-section">
    <h3>Test the Guard</h3>
    <p>Try these actions to test the unsaved changes guard:</p>
    <ul>
      <li>âœï¸ Modify any field and click "Back to Challenges" - You'll see a confirmation dialog</li>
      <li>âœ… Save the form and navigate - No confirmation needed</li>
      <li>ğŸ”™ Use browser back button with unsaved changes - Guard will protect</li>
      <li>ğŸ”„ Try refreshing the page with unsaved changes - Browser warning appears</li>
    </ul>
    <div class="test-links">
      <a routerLink="/challenges/angular-routing/authorized-resource-access/workspace" class="test-link">
        â†’ Navigate to Another Challenge
      </a>
    </div>
  </div>

  <!-- Form State Debug Info -->
  <div class="debug-info">
    <h4>Form State (Debug)</h4>
    <div class="debug-grid">
      <div class="debug-item">
        <span class="debug-label">Dirty:</span>
        <span [class.active]="userForm.dirty">{{ userForm.dirty }}</span>
      </div>
      <div class="debug-item">
        <span class="debug-label">Pristine:</span>
        <span [class.active]="userForm.pristine">{{ userForm.pristine }}</span>
      </div>
      <div class="debug-item">
        <span class="debug-label">Valid:</span>
        <span [class.active]="userForm.valid">{{ userForm.valid }}</span>
      </div>
      <div class="debug-item">
        <span class="debug-label">Saved:</span>
        <span [class.active]="saved()">{{ saved() }}</span>
      </div>
      <div class="debug-item">
        <span class="debug-label">Can Deactivate:</span>
        <span [class.active]="canDeactivate()">{{ canDeactivate() }}</span>
      </div>
    </div>
  </div>
</div>
